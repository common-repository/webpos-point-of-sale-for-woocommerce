!function(e){"use strict";e(document).ready((function(){let o,t,s,i={},c={},a=window.screen.width<=800;e(document).on("click",".viwebpos-add-custom-product-wrap",(function(o){e(".viwebpos-popup-wrap-add-product").removeClass("viwebpos-popup-wrap-hidden").addClass("viwebpos-popup-wrap-show"),e(".viwebpos-popup-wrap-add-product").find(".viwebpos-popup-bt-loading").removeClass("viwebpos-popup-bt-loading"),e(".viwebpos-popup-wrap-add-product").find(".viwebpos-custom-product-name").trigger("focus")})),e(document.body).on("viwebpos_popup_after_close",(function(o,t){(t.hasClass("viwebpos-popup-wrap-add-product")||t.hasClass("viwebpos-popup-wrap-print-receipt"))&&t.find("input, select").each((function(){e(this).val(e(this).data("value_default")||"")}))})),e(document).on("click",".viwebpos-product-qty-action",(function(){let o=e(this).closest(".viwebpos-product-qty-wrap").find(".viwebpos-product-qty-value"),t=o.val()||0;e(this).hasClass("viwebpos-product-qty-minus")?t--:t++,o.val(t).trigger("change")})),e(document).on("click","body",(function(){e(document.body).trigger("viwebpos_search_products_close"),e(document.body).trigger("viwebpos_checkout_search_customers_close")})),e(document).on("click",".viwebpos-header-action-icons-auto_print",(function(o){e(document.body).trigger("viwebpos_set_auto_print_receipt_after_checkout",[e(this).hasClass("viwebpos-header-action-icons-auto_print-disable")])})),function(){e(document.body).on("viwebpos_search_products_close",(function(){i={},e(".viwebpos-search-product").val(null),e(".viwebpos-search-product-result-wrap").remove()})),e(document.body).on("viwebpos_search_products_init",(function(o,t){let s,i;e(".viwebpos-search-product-result-wrap").length||e(".viwebpos-header-search-wrap").append('<div class="viwebpos-search-product-result-wrap"></div>'),i=e(".viwebpos-search-product-result-wrap");let c=i.find(".viwebpos-search-product-loadmore").length;c&&i.find(".viwebpos-search-product-loadmore").data("next_page")||i.html(""),i.find(".viwebpos-search-product-loadmore").remove(),t.length&&t.at(-1).next_page?(c=t.at(-1).next_page,t.pop()):c=!1,e.each(t,(function(e,o){let t,c=o.is_purchasable,a=o.stock?o.stock:"";if(s="",s+='<div class="viwebpos-search-product-result'+(c?"":" viwebpos-search-product-disabled")+`"  title="${o.name}">`,s+='<div class="viwebpos-search-product-image">'+o.image+"</div>",s+='<div class="viwebpos-search-product-info">',s+='<div class="viwebpos-search-product-info1'+(o.price?"":" viwebpos-search-product-not_price")+'" >',s+='<div class="viwebpos-search-product-name">'+o.name+"</div>",o.price){let e=parseFloat(o.regular_price)>parseFloat(o.price)?viwebpos_get_product_price(o,1,o.regular_price):"";t=viwebpos_get_product_price(o),t=e?'<del><span class="amount">'+e+'</span></del><ins><span class="amount">'+t+"</span></ins>":t}t&&(s+='<div class="viwebpos-search-product-price">'+t+"</div>"),s+="</div>",s+='<div class="viwebpos-search-product-info2">',o.barcode&&(s+='<div class="viwebpos-search-product-barcode">'+o.barcode+"</div>"),a?s+='<div class="viwebpos-search-product-stock">'+(viwebpos.product_stock_title||"Stock")+":&ensp;"+a+"</div>":o.stock_status&&(s+='<div class="viwebpos-search-product-stock">'+o.stock_status+"</div>"),o.attribute_html&&(s+='<div class="viwebpos-search-product-swatches">'+o.attribute_html+"</div>"),s+="</div></div>",i.append(s),i.find(".viwebpos-search-product-result").last().data("product_data",o),i.find('.viwebpos-attribute-options option[value=""]').prop("disabled",!0)})),c?(i.append(`<div class="viwebpos-search-product-loadmore" data-next_page="${c}"></div>`),e(".viwebpos-search-product-result-wrap").on("scroll",(function(){if(!e(".viwebpos-search-product-loadmore:not(.viwebpos-search-product-loadmore-loading)").length)return!1;let o=e(".viwebpos-search-product-loadmore:not(.viwebpos-search-product-loadmore-loading)")[0],t=e(this)[0];o.getBoundingClientRect().top-t.getBoundingClientRect().height<t.getBoundingClientRect().top&&(e(".viwebpos-search-product-loadmore").addClass("viwebpos-search-product-loadmore-loading"),e(document.body).trigger("viwebpos_search_products",[e(".viwebpos-search-product").val().toString().trim(),parseInt(e(".viwebpos-search-product-loadmore").data("next_page"))]))}))):(e(".viwebpos-search-product-result").length||i.html('<div class="viwebpos-search-product-empty">'+(viwebpos.search_product_empty||"No product found")+"</div>"),viwebpos_data.data_settings_bill&&viwebpos_data.data_settings_bill.auto_atc&&1===e(".viwebpos-search-product-result").length&&!e(".viwebpos-search-product-disabled").length&&!e(".viwebpos-search-product-swatches select").length&&e(".viwebpos-search-product-result").trigger("click"))})),e(document).on("click",".viwebpos-attribute-options",(function(o){o.preventDefault(),o.stopPropagation(),o.stopImmediatePropagation(),e(this).hasClass("viwebpos-attribute-options-changed")?e(this).removeClass("viwebpos-attribute-options-changed"):e(this).closest(".viwebpos-search-product-result").addClass("viwebpos-search-product-result-loading"),e(this).on("change",(function(o){e(this).val()||e(this).val(e(this).find("option").eq(1).val()),e(this).addClass("viwebpos-attribute-options-changed").closest(".viwebpos-search-product-result").removeClass("viwebpos-search-product-result-loading")}))})),"undefined"!=typeof onScan&&onScan.attachTo(document,{ignoreIfFocusOn:".viwebpos-wrap input:not(.viwebpos-search-product)",onScan:function(o,t){if(!e(".viwebpos-search-input.viwebpos-search-product").length)return!1;e(".viwebpos-search-input.viwebpos-search-product").addClass("viwebpos-search-product-scanned").trigger("focus").val(o)}});e(document.body).on("viwebpos_search_products",(function(t,s="",c=1){o&&clearTimeout(o),o=setTimeout((function(o,t){if(!o&&!a)return e(document.body).trigger("viwebpos_search_products_close"),!1;e(".viwebpos-search-product-result-wrap").length||e(".viwebpos-header-search-wrap").append('<div class="viwebpos-search-product-result-wrap"></div>'),e(".viwebpos-search-product-result-wrap .viwebpos-search-product-loadmore").length||e(".viwebpos-search-product-result-wrap").append('<div class="viwebpos-search-product-loadmore"></div>');let s=e(document.body).triggerHandler("viwebpos_search_data",["products",o,30,t]);"function"==typeof s.then?s.then((function(t){1===c&&(i[o]={...t},e(".viwebpos-search-product-loadmore").remove()),e(document.body).trigger("viwebpos_search_products_init",[t])})):(1===c&&(i[o]={...s},e(".viwebpos-search-product-loadmore").remove()),e(document.body).trigger("viwebpos_search_products_init",[s]))}),100,s,c)})),e(document).on("click keyup",".viwebpos-search-product",(function(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),e(document.body).trigger("viwebpos_checkout_search_customers_close");let s=e(this),c=s.val();if(o&&clearTimeout(o),s.data("old_key",c),i[c])return e(document.body).trigger("viwebpos_search_products_init",[Object.values(i[c])]),!1;e(document.body).trigger("viwebpos_search_products",c.toString().trim())})),e(document).on("change",".viwebpos-cart-contents .viwebpos-attribute-options",(function(o){let t={};e(this).closest(".viwebpos-cart-item-swatches").find("select, input").each((function(){let o=e(this).attr("name");o&&(t[o]=e(this).val())})),e(document.body).trigger("viwebpos_update_cart_variation",[e(this).closest(".viwebpos-cart-item-wrap").data("cart_item_key")||"",t])})),e(document).on("click",".viwebpos-search-product-result:not(.viwebpos-search-product-result-loading)",(function(o){o.preventDefault(),o.stopPropagation(),o.stopImmediatePropagation();let t=e(this),s=!0;if(e(document.body).trigger("villatheme_show_message_timeout",[e(".villatheme-show-message-message-product-adding"),1]),t.hasClass("viwebpos-search-product-disabled"))return e(document.body).trigger("villatheme_show_message",[viwebpos.error_title,["error","product-adding"],viwebpos.cannot_be_purchased_message,!1,4500]),!1;t.find(".viwebpos-attribute-options").each((function(o,t){if(!e(t).val())return s=!1,!1})),s||e(document.body).trigger("villatheme_show_message",[viwebpos.error_title,["error","product-adding"],viwebpos.make_a_selection_text.replace("{product_name}",t.attr("title")),!0,4500]);let i={};t.find("select, input").each((function(){let o=e(this).attr("name");o&&(i[o]=e(this).val())}));let c=t.data("product_data");e(document.body).trigger("viwebpos_add_to_cart",[c,i,1])})),e(document).on("click",".viwebpos-popup-bt-add-product:not(.viwebpos-popup-bt-loading)",(function(o){o.preventDefault(),o.stopPropagation(),o.stopImmediatePropagation();let t=e(this).closest(".viwebpos-popup-wrap-add-product"),s={type:"custom",barcode:"",taxable:!0,stock:null,is_in_stock:1};return t.find(".viwebpos-custom-product-name").val()?(s.name=t.find(".viwebpos-custom-product-name").val(),t.find(".viwebpos-price-input-value").val()?(s.price=t.find(".viwebpos-price-input-value").val(),parseFloat(t.find(".viwebpos-product-qty-value").val()||0)<=0?(e(document.body).trigger("villatheme_show_message",[viwebpos.custom_product_qty,["error","product-adding"],"",!1,4500]),t.find(".viwebpos-product-qty-value").trigger("focus"),!1):(e(this).addClass("viwebpos-popup-bt-loading"),void e(document.body).trigger("viwebpos_add_to_cart",[s,{},parseFloat(t.find(".viwebpos-product-qty-value").val())]))):(e(document.body).trigger("villatheme_show_message",[viwebpos.custom_product_price_empty,["error","product-adding"],"",!1,4500]),t.find(".viwebpos-price-input-value").trigger("focus"),!1)):(e(document.body).trigger("villatheme_show_message",[viwebpos.custom_product_name_empty,["error","product-adding"],"",!1,4500]),t.find(".viwebpos-custom-product-name").trigger("focus"),!1)})),e(document).on("mouseenter",".viwebpos-search-product-result",(function(){e(this).addClass("viwebpos-search-product-result-mouseenter")})).on("mouseleave",".viwebpos-search-product-result",(function(){e(this).removeClass("viwebpos-search-product-result-mouseenter")})),e(document).on("change",".viwebpos-cart-contents .viwebpos-cart-item-qty",(function(o){let t=parseFloat(e(this).val()),s=parseFloat(e(this).data("old_qty")||t-1);e(this).data("old_qty",t),t!==s&&e(document.body).trigger("viwebpos_update_cart_quantity",[e(this).closest(".viwebpos-cart-item-wrap").data("cart_item_key")||"",t])})),e(document).on("click",".viwebpos-cart-contents .viwebpos-cart-item-bt-remove",(function(o){e(document.body).trigger("viwebpos_update_cart_quantity",[e(this).closest(".viwebpos-cart-item-wrap").data("cart_item_key")||"",0])})),e(document).on("click",".viwebpos-cart-contents .viwebpos-cart-item-bt-add-note",(function(o){e(this).closest(".viwebpos-cart-item-wrap").addClass("viwebpos-cart-item-wrap-has-note").next(".viwebpos-cart-item-wrap-note").find("input").trigger("focus")})),e(document).on("change",".viwebpos-cart-item-note input",(function(){e(document.body).trigger("viwebpos_add_order_note",[e(this).val(),e(this).closest(".viwebpos-cart-item-wrap").data("cart_item_key")||""])})),e(document).on("mouseenter",".viwebpos-cart-item-wrap-note",(function(){e(this).prev(".viwebpos-cart-item-wrap").addClass("viwebpos-cart-item-wrap-mouseenter")})).on("mouseleave",".viwebpos-cart-item-wrap-note",(function(){e(".viwebpos-cart-item-wrap-mouseenter").removeClass("viwebpos-cart-item-wrap-mouseenter")})),e(document).on("change",".viwebpos-cart-contents-order-textarea",(function(){e(".viwebpos-cart-contents-order-note").html(e(this).val()),e(document.body).trigger("viwebpos_add_order_note",[e(this).val()])})),e(document).on("mouseenter",".viwebpos-cart-contents-add-note-icon",(function(){e(".viwebpos-cart-contents-order-textarea").trigger("focus")})),e(document).on("click",".viwebpos-cart-contents-reset-icon:not(.viwebpos-hidden)",(function(){e(document.body).trigger("viwebpos_remove_all_cart_items")}))}(),e(document.body).on("viwebpos_checkout_search_customers_close",(function(){c={},e(".viwebpos-checkout-form-customer-wrap .viwebpos-checkout-search-customer:not(.viwebpos-checkout-search-customer-found)").val(null),e(".viwebpos-checkout-form-customer-wrap .viwebpos-search-customers-result-wrap").remove()})),e(document).on("click",".viwebpos-checkout-form-customer-remove-icon",(function(){e(document.body).trigger("viwebpos_set_cart_customer")})),e(document).on("click",".viwebpos-checkout-form-customer-search-icon",(function(){e(".viwebpos-popup-wrap-add-customer").removeClass("viwebpos-popup-wrap-hidden").addClass("viwebpos-popup-wrap-show"),e(".viwebpos-popup-wrap-add-customer").find(".viwebpos-popup-bt-loading").removeClass("viwebpos-popup-bt-loading"),e(".viwebpos-popup-wrap-add-customer").find(".viwebpos-popup-content-value-error").removeClass("viwebpos-popup-content-value-error"),e(".viwebpos-popup-wrap-add-customer").find("input, select").each((function(){e(this).is("select")&&e(this).closest(".vi-ui.dropdown").length?e(this).val(e(this).data("value_default")||"").trigger("change"):e(this).val(e(this).data("value_default")||"")})),e(".viwebpos-popup-wrap-add-customer").find(".viwebpos-add-customer-first-name").trigger("focus")})),e(document).on("change",".viwebpos-popup-wrap-add-customer .viwebpos-add-customer-country select",(function(){let o=e(this).closest(".viwebpos-popup-wrap-add-customer"),t=e(this).val(),s=o.find(".viwebpos-customer-search-state").length?o.find(".viwebpos-customer-search-state"):o.find(".viwebpos-add-customer-state");e(document.body).trigger("viwebpos_customer_state_init",[t,s,'<input type="text" class="viwebpos-add-customer-state" data-value_default="" value="">'])})),e(document).on("change",".viwebpos-popup-wrap-add-customer .viwebpos-add-customer-email",(function(){let o=e(this).closest(".viwebpos-popup-wrap-add-customer");if(!e(document.body).triggerHandler("viwebpos_check_is_email",o.find(".viwebpos-add-customer-email").val()))return e(document.body).trigger("villatheme_show_message",[viwebpos.error_customer_invalid_email,["error","customer-adding"],"",!1,4500]),o.find(".viwebpos-add-customer-email").addClass("viwebpos-popup-content-value-error").trigger("focus"),!1;let t={email:o.find(".viwebpos-add-customer-email").val()||""};e(document.body).trigger("viwebpos_add_new_customer",[t,"check_email"])})),e(document).on("click",".viwebpos-popup-bt-add-customer:not(.viwebpos-popup-bt-loading)",(function(o){o.preventDefault(),o.stopPropagation(),o.stopImmediatePropagation();let t=e(this).closest(".viwebpos-popup-wrap-add-customer"),s=e(this);e(document.body).trigger("villatheme_show_message_timeout",[e(".villatheme-show-message-message-customer-adding"),1]),t.addClass("viwebpos-popup-wrap-loading").find(".viwebpos-popup-content-value-error").removeClass("viwebpos-popup-content-value-error"),s.addClass("viwebpos-popup-bt-loading");let i={first_name:t.find(".viwebpos-add-customer-first-name"),last_name:t.find(".viwebpos-add-customer-last-name"),email:t.find(".viwebpos-add-customer-email"),phone:t.find(".viwebpos-add-customer-phone"),address_1:t.find(".viwebpos-add-customer-address1"),postcode:t.find(".viwebpos-add-customer-postcode"),city:t.find(".viwebpos-add-customer-city"),state:t.find(".viwebpos-add-customer-state"),country:t.find(".viwebpos-add-customer-country")},c=e(document.body).triggerHandler("viwebpos_customer_fields_validate",[i,"viwebpos-popup-content-value-error"]),a=[];if(c&&c.length)return e.each(c,(function(e,o){o&&a.push({message:o,status:["error","customer-adding"]})})),e(document.body).trigger("villatheme_show_messages",[a]),t.find(".viwebpos-popup-content-value-error").eq(0).trigger("focus"),!1;let r={email:t.find(".viwebpos-add-customer-email").val()||"",first_name:t.find(".viwebpos-add-customer-first-name").val()||"",last_name:t.find(".viwebpos-add-customer-last-name").val()||"",billing_address:{address_1:t.find(".viwebpos-add-customer-address1").val(),city:t.find(".viwebpos-add-customer-city").val(),country:t.find(".viwebpos-add-customer-country").val(),state:t.find(".viwebpos-add-customer-state").val(),postcode:t.find(".viwebpos-add-customer-postcode").val(),phone:t.find(".viwebpos-add-customer-phone").val()||""}};t.find(".viwebpos-add-customer-country select").length&&(r.billing_address.country=t.find(".viwebpos-add-customer-country select").val()),t.find(".viwebpos-add-customer-state select").length&&(r.billing_address.state=t.find(".viwebpos-add-customer-state select").val()),e(document.body).trigger("viwebpos_add_new_customer",[r,!0])})),e(document).on("click",".viwebpos-search-customer-result:not(.viwebpos-search-customer-result-loading)",(function(o){o.preventDefault(),o.stopPropagation(),o.stopImmediatePropagation();let t=e(this).data();if(!t.customer_id||!t.customer_data)return!1;e(document.body).trigger("viwebpos_set_cart_customer",[t.customer_data])})),e(document.body).on("viwebpos_checkout_search_customers_init",(function(o,t){let s,i=0;e(".viwebpos-checkout-form-customer-wrap .viwebpos-search-customers-result-wrap").length||e(".viwebpos-checkout-form-customer-wrap .viwebpos-checkout-form-customer").append('<div class="viwebpos-search-customers-result-wrap"></div>'),s=e(".viwebpos-checkout-form-customer-wrap .viwebpos-search-customers-result-wrap"),s.html(""),e.each(t,(function(o,t){let c="",a=t.first_name||t.last_name?t.first_name+" "+t.last_name:t.username;c+='<div class="viwebpos-search-customer-result" title="'+t.username+'">',c+='<div class="viwebpos-search-customer-info">',c+='<div class="viwebpos-search-customer-name">'+a+"</div>",c+='<div class="viwebpos-search-customer-email">'+t.email+"</div>",c+="</div>",c+='<div class="viwebpos-search-customer-info">',t.phone?c+='<div class="viwebpos-search-customer-phone">'+viwebpos.customer_phone+":&ensp;"+t.phone+"</div>":c+='<div class="viwebpos-search-customer-id">'+viwebpos.customer_id+":&ensp;"+t.id+"</div>",c+="</div></div>",c=e(c),c.data({customer_id:t.id,customer_data:t}),s.append(c),i++})),i||s.html('<div class="viwebpos-search-customer-empty">'+(viwebpos.search_customer_empty||"No cutomer found")+"</div>")})),e(document).on("click keyup",".viwebpos-checkout-form-customer .viwebpos-checkout-search-customer:not(.viwebpos-checkout-search-customer-found)",(function(o){o.preventDefault(),o.stopPropagation(),o.stopImmediatePropagation(),e(document.body).trigger("viwebpos_search_products_close");let s=e(this),i=s.val();return i!==(s.data("old_key")||"")&&(t&&clearTimeout(t),e(".viwebpos-checkout-form-customer-wrap .viwebpos-search-customers-result-wrap").length||e(".viwebpos-checkout-form-customer-wrap .viwebpos-checkout-form-customer").append('<div class="viwebpos-search-customers-result-wrap"></div>'),e(".viwebpos-checkout-form-customer-wrap .viwebpos-search-customers-result-wrap").html('<div class="viwebpos-search-customers-loadmore"></div>'),s.data("old_key",i),c[i]?(e(document.body).trigger("viwebpos_checkout_search_customers_init",[c[i]]),!1):void(t=setTimeout((function(o){if(!o)return e(document.body).trigger("viwebpos_checkout_search_customers_close"),!1;let t=e(document.body).triggerHandler("viwebpos_search_data",["customers",o,20,1]);"function"==typeof t.then?t.then((function(t){c[o]=t,e(document.body).trigger("viwebpos_checkout_search_customers_init",[t])})):(c[o]=t,e(document.body).trigger("viwebpos_checkout_search_customers_init",[t]))}),500,i.toString().trim())))})),function(){e(document).on("focus",".viwebpos-checkout-form-content .viwebpos-checkout-form-content-paid-input",(function(o){e(this).trigger("select")})),e(document).on("change keyup",".viwebpos-checkout-form-content .viwebpos-checkout-form-content-paid-input",(function(o){let t=e(this).val(),i=e(this).data("val");if("keyup"===o.type&&(!t||i===t))return e(".viwebpos-checkout-form-content-paid-input-checkout_after_change").length&&(e(".viwebpos-wrap").addClass("viwebpos-wrap-loading"),e(".viwebpos-checkout-form-footer-checkout-wrap").trigger("click")),!1;t||"change"!==o.type||(e(".viwebpos-checkout-form-content-paid-input-checkout_after_change").removeClass("viwebpos-checkout-form-content-paid-input-checkout_after_change"),t=e(".viwebpos-checkout-form-content-need_to_pay .viwebpos-checkout-form-content-value").html()),e(this).addClass("viwebpos-checkout-form-content-paid-input1");let c=t.length,a=e(this).prop("selectionStart"),r=e(document.body).triggerHandler("viwebpos_format_price_input",[t,o.type]);t=r[0]||t,e(this).val(t).data("val",t),"change"!==o.type?(a=t.length-c+a,e(this)[0].setSelectionRange(a,a),e(this).addClass("viwebpos-checkout-form-content-paid-input2")):e(this).removeClass("viwebpos-checkout-form-content-paid-input2"),s&&clearTimeout(s),s=setTimeout((function(o,t){let s=e(".viwebpos-checkout-form-content-paid1:not(.viwebpos-hidden)").data("paid")||{};s[o.data("method")||"cash"]=t,e(document.body).trigger("viwebpos_checkout_set_payments",[s])}),"keyup"===o.type?2500:500,e(this),r[1]||0)})),e(document.body).on("viwebpos_format_price_input",(function(e,o="",t="change"){if(!o&&"change"===t)return[o=viwebpos_get_price_html(0),0];let s,i,c,a=viwebpos_price.wc_get_price_decimals,r=viwebpos_price.wc_price_decimal_separator,p=viwebpos_price.wc_price_thousand_separator;return c=p===r&&"."===r?o.lastIndexOf(r):o.indexOf(r),c<0&&(c=o.lastIndexOf(r)),c>=0&&(s=o.substring(c)),(c<0||(p===r||"."===p)&&4===s.length)&&(s=""),s?(s="."+s.replace(/\D/g,""),i=o.substring(0,c).replace(/\D/g,"")):i=o.replace(/\D/g,""),[o="change"===t?viwebpos_get_price_html(i?i+s:0,a,r,p,"%2$s"):s&&s.length>a?i?viwebpos_get_price_html(i+s,a,r,p,"%2$s"):"":i?viwebpos_get_price_html(i,0,r,p,"%2$s")+s:"",i?i+s:0]})),e(document).on("click",".viwebpos-checkout-form-content-need_to_pay",(function(){e(this).closest(".viwebpos-checkout-form-content-wrap").find(".viwebpos-checkout-form-content-paid-input").val(e(this).find(".viwebpos-checkout-form-content-value").html()).trigger("change")})),e(document).on("click",".viwebpos-checkout-form-content-value-amount",(function(){e(this).closest(".viwebpos-checkout-form-content-wrap").find(".viwebpos-checkout-form-content-paid-input").val(e(this).data("val")).trigger("change")})),e(document).on("change",'input[name="payment-method"]',(function(){let o=e(this).closest(".viwebpos-checkout-form-content-wrap-payment"),t=e(this).val();o.find(".viwebpos-checkout-form-content-amount-input").data("method",t).trigger("change")})),e(document).on("click",".viwebpos-checkout-form-footer-action:not(.viwebpos-hidden)",(function(){if(e(".viwebpos-bill-of-sale-container-empty").length||!e(".viwebpos-cart-item-wrap").length)return e(document.body).trigger("villatheme_show_message",[viwebpos.checkout_cart_empty_message,["error","payment-settings"],"",!1,4500]),!1;let o=e(this).data("type");if(o&&(e(".viwebpos-checkout-form-content-wrap, .viwebpos-checkout-form-footer-action").addClass("viwebpos-hidden"),e(".viwebpos-checkout-form-content-wrap-"+o+", .viwebpos-checkout-form-footer-back-to-bill").removeClass("viwebpos-hidden"),"payment"===o))e(".viwebpos-checkout-form-content-amount-input.viwebpos-checkout-form-content-paid-input").trigger("focus")})),e(document).on("click",".viwebpos-checkout-form-footer-back-to-bill:not(.viwebpos-hidden)",(function(){e(".viwebpos-checkout-form-content-wrap, .viwebpos-checkout-form-footer-action").addClass("viwebpos-hidden"),e(".viwebpos-checkout-form-content-wrap-total, .viwebpos-checkout-form-footer-action:not(.viwebpos-checkout-form-footer-back-to-bill)").removeClass("viwebpos-hidden"),e(".viwebpos-checkout-form-content-paid-input:not(.viwebpos-checkout-form-content-amount-input)").trigger("focus")})),viwebpos.wc_coupons_enabled&&(e(document).on("click",".viwebpos-checkout-apply-coupon-button:not(.loading)",(function(o){let t=e(".viwebpos-checkout-apply-coupon-input").val();if(!t)return e(document.body).trigger("villatheme_show_message",[viwebpos.coupon_please_enter,["error","apply-coupon"],"",!1,4500]),!1;e(this).addClass("loading"),e(".viwebpos-checkout-form-footer-checkout-wrap").addClass("loading"),e(document.body).trigger("viwebpos_cart_add_discount",[t])})),e(document).on("click",".viwebpos-checkout-form-content-coupon .viwebpos-checkout-form-content-coupon-info .icon",(function(o){o.preventDefault(),o.stopPropagation(),e(document.body).trigger("viwebpos_search_products_close"),e(document.body).trigger("viwebpos_checkout_search_customers_close"),e(document.body).trigger("viwebpos_cart_remove_coupon",[e(this).closest(".viwebpos-checkout-form-content-full-info").data("coupon")])})));e(document).on("click",".viwebpos-checkout-form-footer-checkout-wrap:not(.loading):not(.viwebpos-hidden)",(function(){if(e(".viwebpos-bill-of-sale-container-empty").length||!e(".viwebpos-cart-item-wrap").length)return e(document.body).trigger("villatheme_show_message",[viwebpos.checkout_cart_empty_message,["error","place-order"],"",!1,4500]),!1;let o=e(document).triggerHandler("viwebpos_cancel_checkout_message");o?e(document.body).trigger("villatheme_show_message",[o,["error","place-order"],"",!1,6500]):(e(this).addClass("loading"),e(document.body).trigger("viwebpos_create_order"))})),e(document).on("click",'.viwebpos-popup-wrap-settings-pos-init input[type="checkbox"]',(function(){let o=e(this).data("name");e(this).prop("checked")?e("input#viwebpos-settings-pos-"+o).val(1):e("input#viwebpos-settings-pos-"+o).val(""),e(document.body).trigger("viwebpos_settings_pos")})),e(document).on("change",".viwebpos-popup-wrap-settings-pos-init select",(function(){let o=e(this).val();if("object"!=typeof o)return e("input#viwebpos-settings-pos-"+e(this).data("name")).val(o),void e(document.body).trigger("viwebpos_settings_pos");e(this).find("option").each((function(t,s){o.includes(e(s).val())?e("input#viwebpos-settings-pos-"+e(s).val()).val(""):e("input#viwebpos-settings-pos-"+e(s).val()).val(1)})),e(document.body).trigger("viwebpos_settings_pos")}))}(),e(document.body).on("viwebpos-bill-of-sale-load",(function(){if(!e(".viwebpos-bill-of-sale-container").length){let o='<div class="viwebpos-container-element viwebpos-bill-of-sale-container"><div class="viwebpos-cart-contents-container">';o+='<div class="viwebpos-cart-contents"><table class="viwebpos-cart-items-wrap"></table></div>',o+='<div class="viwebpos-cart-contents-reset-and-note">',o+='<span class="viwebpos-cart-contents-reset-icon" data-position="top '+(e(".viwebpos-wrap.rtl").length?"right":"left")+'" data-tooltip="'+viwebpos.remove_all_items+'"><i class="icon trash alternate outline"></i></span>',o+='<span class="viwebpos-cart-contents-add-note-icon"><i class="icon exclamation alternate"></i></span>',o+='<textarea rows="4" cols="50" class="viwebpos-cart-contents-order-textarea" placeholder="'+viwebpos.add_order_note+'"></textarea><div class="viwebpos-cart-contents-order-note"></div></div></div>',o+='<div class="viwebpos-checkout-form-container">',o+='<div class="viwebpos-checkout-form-customer-wrap">',o+='<div class="viwebpos-checkout-form-customer">',o+='<input type="text" class="viwebpos-search-input viwebpos-checkout-search-customer" placeholder="'+viwebpos.search_customer+'">',o+='<div class="viwebpos-checkout-form-customer-icon viwebpos-checkout-form-customer-search-icon"',e(".viwebpos-wrap.rtl").length?o+='data-position="bottom left"':o+='data-position="bottom right"',o+=` data-tooltip="${viwebpos.add_new_customer}"><i class="user plus icon"></i></div>`,o+='<div class="viwebpos-checkout-form-customer-icon viwebpos-checkout-form-customer-remove-icon" >+</div>',o+="</div></div>",o+='<div class="viwebpos-checkout-form-content-wrap viwebpos-checkout-form-content-wrap-total">',o+='<div class="viwebpos-checkout-form-content viwebpos-checkout-form-content-subtotal"><div class="viwebpos-checkout-form-content-title">'+viwebpos.subtotal_title+'</div><div class="viwebpos-checkout-form-content-value"></div></div>',o+='<div class="viwebpos-checkout-form-content viwebpos-checkout-form-content-tax"><div class="viwebpos-checkout-form-content-title">'+viwebpos.tax_title+'</div><div class="viwebpos-checkout-form-content-value"></div></div>',o+='<div class="viwebpos-checkout-form-content viwebpos-checkout-form-content-full viwebpos-checkout-form-content-coupon viwebpos-hidden"></div>',o+='<div class="viwebpos-checkout-form-content viwebpos-checkout-form-content-need_to_pay"><div class="viwebpos-checkout-form-content-title">'+viwebpos.need_to_pay_title+'</div><div class="viwebpos-checkout-form-content-value"></div></div>',o+='<div class="viwebpos-checkout-form-content viwebpos-checkout-form-content-paid">',o+='<div class="viwebpos-checkout-form-content-title">'+viwebpos.paid_title+'<div class="viwebpos-keyboard-label"> (F8)</div></div>',o+='<div class="viwebpos-checkout-form-content-value">',o+=viwebpos_price.wc_price_format.toString().replace("%1$s",`<span class="viwebpos-currency-symbol">${viwebpos_price.wc_currency_symbol}</span>`).replace("%2$s",'<input type="text" value="" class="viwebpos-checkout-form-content-paid-input">'),o+="</div></div>",o+='<div class="viwebpos-checkout-form-content viwebpos-checkout-form-content-amount viwebpos-checkout-form-content-amount-choose viwebpos-hidden">',o+='<div class="viwebpos-checkout-form-content-title"></div>',o+='<div class="viwebpos-checkout-form-content-value"></div>',o+="</div>",o+='<div class="viwebpos-checkout-form-content viwebpos-checkout-form-content-change"><div class="viwebpos-checkout-form-content-title">'+viwebpos.change_title+"</div>",o+='<div class="viwebpos-checkout-form-content-value"></div></div>',o+="</div>",viwebpos.viwebpos_payments&&(o+='<div class="viwebpos-checkout-form-content-wrap viwebpos-checkout-form-content-wrap-payment viwebpos-hidden">',o+='<div class="viwebpos-checkout-form-content viwebpos-checkout-form-content-amount">',o+='<div class="viwebpos-checkout-form-content-title">'+viwebpos.pay_amount_title+'<div class="viwebpos-keyboard-label"> (F8)</div></div>',o+='<div class="viwebpos-checkout-form-content-value">',o+=viwebpos_price.wc_price_format.toString().replace("%1$s",`<span class="viwebpos-currency-symbol">${viwebpos_price.wc_currency_symbol}</span>`).replace("%2$s",'<input type="text" value="" class="viwebpos-checkout-form-content-amount-input viwebpos-checkout-form-content-paid-input">'),o+="</div>",o+="</div>",o+='<div class="viwebpos-checkout-form-content viwebpos-checkout-form-content-amount viwebpos-checkout-form-content-amount-choose">',o+='<div class="viwebpos-checkout-form-content-title"></div>',o+='<div class="viwebpos-checkout-form-content-value"></div>',o+="</div>",o+='<div class="viwebpos-checkout-form-content viwebpos-checkout-form-content-payment-method">',o+='<div class="viwebpos-checkout-form-content-title"></div>',o+='<div class="viwebpos-checkout-form-content-value">',e.each(viwebpos.viwebpos_payments,(function(e,t){o+='<div class="vi-ui radio checkbox">',o+='<input type="radio" value="'+e+'" name="payment-method" class="viwebpos-checkout-form-content-value-payment" id="viwebpos-checkout-form-content-value-payment-'+e+'">',o+='<label for="viwebpos-checkout-form-content-value-payment-'+e+'">'+t.title+"</label>",o+="</div>"})),o+="</div></div>",o+='<div class="viwebpos-checkout-form-content viwebpos-checkout-form-content-total"><div class="viwebpos-checkout-form-content-title">'+viwebpos.total_title+"</div>",o+='<div class="viwebpos-checkout-form-content-value"></div></div>',o+='<div class="viwebpos-checkout-form-content viwebpos-checkout-form-content-paid"><div class="viwebpos-checkout-form-content-title">'+viwebpos.paid_title+"</div>",o+='<div class="viwebpos-checkout-form-content-value"></div></div>',o+='<div class="viwebpos-checkout-form-content viwebpos-checkout-form-content-change"><div class="viwebpos-checkout-form-content-title">'+viwebpos.change_title+"</div>",o+='<div class="viwebpos-checkout-form-content-value"></div></div>',o+="</div>"),viwebpos.wc_coupons_enabled&&(o+='<div class="viwebpos-checkout-form-content-wrap viwebpos-checkout-form-content-wrap-coupon viwebpos-hidden">',o+='<div class="viwebpos-checkout-form-content viwebpos-checkout-form-content-full viwebpos-checkout-form-content-coupon1">',o+='<input type="text" class="viwebpos-checkout-apply-coupon-input" placeholder="'+viwebpos.coupon_input_placeholder+'">',o+='<div class="vi-ui button positive viwebpos-checkout-apply-coupon-button">'+viwebpos.coupon_bt_title+"</div>",o+="</div>",o+='<div class="viwebpos-checkout-form-content viwebpos-checkout-form-content-full viwebpos-checkout-form-content-coupon viwebpos-hidden"></div>',o+="</div>"),o+='<div class="viwebpos-checkout-form-footer-wrap" >',o+='<div class="viwebpos-checkout-form-footer-action-wrap'+(viwebpos.viwebpos_payments&&viwebpos.wc_coupons_enabled?" viwebpos-checkout-form-footer-multi-action-wrap":"")+'">',viwebpos.wc_coupons_enabled&&(o+='<div class="viwebpos-checkout-form-footer-action viwebpos-checkout-form-footer-coupon" data-type="coupon"><i class="gift icon"></i>',o+='<div class="viwebpos-checkout-form-footer-coupon-title">'+viwebpos.coupon_title+'</div><div class="viwebpos-keyboard-label"> (F4)</div>',o+="</div>"),viwebpos.viwebpos_payments&&(o+='<div class="viwebpos-checkout-form-footer-action viwebpos-checkout-form-footer-payment" data-type="payment"><i class="credit card outline icon"></i>',o+='<div class="viwebpos-checkout-form-footer-payment-title">'+viwebpos.payment_method_title+'</div>(<div class="viwebpos-checkout-form-footer-payment-value"></div>)',o+='<div class="viwebpos-keyboard-label"> (F9)</div></div>'),(viwebpos.viwebpos_payments||viwebpos.wc_coupons_enabled)&&(o+='<div class="viwebpos-checkout-form-footer-action viwebpos-checkout-form-footer-back-to-bill viwebpos-hidden">',o+='<div class="viwebpos-checkout-form-footer-arrow"><div></div><div></div><div></div></div>',o+='<div class="viwebpos-checkout-form-footer-payment-title">'+viwebpos.back_to_bill_title+"</div>",o+="</div>"),o+="</div>",o+='<div class="viwebpos-checkout-form-footer-checkout-wrap"><div class="viwebpos-checkout-form-footer-title-wrap"><div class="viwebpos-checkout-form-footer-title">'+viwebpos.place_order_title+'</div><div class="viwebpos-keyboard-label"> (F10)</div></div>',o+='<div class="viwebpos-checkout-form-footer-total-wrap"><div class="viwebpos-checkout-form-footer-total"></div><div class="viwebpos-checkout-form-footer-arrow"><div></div><div></div><div></div></div></div></div>',o+="</div></div></div>",e(".viwebpos-container-wrap").prepend(o)}if(!e(".viwebpos-header-search-product").length){let o='<div class="viwebpos-header-search viwebpos-header-search-product">';viwebpos.custom_product_title?(o+='<div class="viwebpos-header-search-icon viwebpos-add-custom-product-wrap"',e(".viwebpos-wrap.rtl").length?o+='data-position="bottom right"':o+='data-position="bottom left"',o+=`data-tooltip="${viwebpos.custom_product_tooltip}">&#43;</div>`):o+='<div class="viwebpos-header-search-icon"><i class="icon search"></i></div>',o+='<input type="text" class="viwebpos-search-input viwebpos-search-product" placeholder="'+viwebpos.search_product+'">',o+="</div>",e(".viwebpos-header-search-wrap").html(o)}!e(".viwebpos-popup-wrap-add-product").length&&viwebpos.custom_product_title&&e(document.body).trigger("viwebpos_get_popup_wrap",["add-product"]),e(".viwebpos-popup-wrap-add-customer").length||e(document.body).trigger("viwebpos_get_popup_wrap",["add-customer"]),e(".viwebpos-popup-wrap-settings-pos").length||e(document.body).trigger("viwebpos_get_popup_wrap",["settings-pos"]),setTimeout((function(){e(document.body).trigger("viwebpos-frontend-loaded")}),100),e(document.body).trigger("viwebpos-bill-of-sale-refresh-cart",[!0])})),e(document.body).on("viwebpos-bill-of-sale-refresh-cart",(function(o,t=!1){let s=e(document.body).triggerHandler("viwebpos_search_data",["carts"]);"function"==typeof s.then?s.then((function(o){e(document.body).trigger("viwebpos_cart_data_validate",[o,t])})):e(document.body).trigger("viwebpos_cart_data_validate",[s,t])})),e(document.body).on("viwebpos-bill-of-sale-get-html",(function(o,t,s=!1){if(e(document.body).trigger("viwebpos-bill-of-sale-before-get-html"),e(".viwebpos-popup-wrap-show").length&&e(document.body).trigger("viwebpos_popup_close"),e(".viwebpos-wrap").removeClass("viwebpos-wrap-loading"),e(".viwebpos-checkout-form-content-error").removeClass("viwebpos-checkout-form-content-error"),!s){e(".viwebpos-bill-of-sale-container-empty").removeClass("viwebpos-bill-of-sale-container-empty");let o=0,s=e('<table class="viwebpos-cart-items-wrap"></table>'),i=[];e.each(t.cart_contents,(function(e,o){i.push(o)})),i.sort((function(e,o){return e.item_serial-o.item_serial}));let c=e(".viwebpos-wrap.rtl").length,a=c?"bottom left":"bottom right";e.each(i,(function(t,i){let r=i.data,p=parseFloat(i.quantity),n=i.key;if(!n||!r||p<=0)return!0;o++;let d=r.name,v=!1;"variation"===r.type&&"object"==typeof i.variation&&e.each(i.variation,(function(e,o){if(""===o||d.toLowerCase().indexOf(" "+o.toLowerCase()+",")>0||0===d.toLowerCase().split("").reverse().join("").indexOf(o.toLowerCase().replace("-"," ").split("").reverse().join(""))||0===d.toLowerCase().split("").reverse().join("").indexOf(o.toLowerCase().split("").reverse().join("")))return o&&(v=!0),!0;d+=v?", "+o:" - "+o,v=!0}));let u='<tr class="viwebpos-cart-item-wrap viwebpos-cart-item-wrap-note">';u+='<td class="viwebpos-cart-item-serial"></td>',u+='<td colspan="5" class="viwebpos-cart-item-note"><input type="text" placeholder="cart item note..." value="'+(i.item_note||"")+'"></td>',u+="<td></td>",u+="</tr>",u=e(u),u.data({cart_item_key:n}),s.prepend(u);let l='<tr class="viwebpos-cart-item-wrap'+(i.item_note?" viwebpos-cart-item-wrap-has-note":"")+'">';l+='<td class="viwebpos-cart-item-serial">'+o+"</td>",l+='<td class="viwebpos-cart-item-name-wrap">',l+='<div class="viwebpos-cart-item-name">',l+=d+"</div>",l+='<div class="viwebpos-cart-item-barcode">'+(r.barcode||"")+"</div>",viwebpos.update_variation_on_cart&&"variation"===r.type&&"object"==typeof i.variation&&r.parent_attributes_html&&(l+='<div class="viwebpos-cart-item-swatches">'+r.parent_attributes_html+"</div>"),l+="</td>",r.is_sold_individually?l+='<td class="viwebpos-cart-item-qty-wrap viwebpos-cart-item-qty-wrap-sold_individually"><span class="viwebpos-cart-item-qty">'+p+"</span></td>":(l+='<td class="viwebpos-cart-item-qty-wrap">',l+='<div class="viwebpos-product-qty-wrap"><span class="viwebpos-product-qty-action viwebpos-product-qty-minus">',l+=c?'<i class="icon chevron right"></i>':'<i class="chevron left icon"></i>',l+="</span>",l+='<input type="number" class="viwebpos-product-qty-value viwebpos-cart-item-qty" value="'+p+'">',l+='<span class="viwebpos-product-qty-action viwebpos-product-qty-plus">',l+=c?'<i class="chevron left icon"></i>':'<i class="icon chevron right"></i>',l+="</span></div>",l+="</td>"),l+='<td class="viwebpos-cart-item-price">'+viwebpos_get_product_price(r)+"</td>",i.line_subtotal?viwebpos.display_prices_including_tax?(l+='<td class="viwebpos-cart-item-subtotal">'+viwebpos_get_price_html(i.line_subtotal+i.line_subtotal_tax),!viwebpos_price.product_price_includes_tax&&i.line_subtotal_tax>0&&(l+=' <small class="tax_label">'+viwebpos.inc_tax_or_vat+"</small>"),l+="</td>"):(l+='<td class="viwebpos-cart-item-subtotal">'+viwebpos_get_price_html(i.line_subtotal),viwebpos_price.product_price_includes_tax&&i.line_subtotal_tax>0&&(l+=' <small class="tax_label">'+viwebpos.ex_tax_or_vat+"</small>"),l+="</td>"):l+='<td class="viwebpos-cart-item-subtotal">'+viwebpos_get_product_price(r,p)+"</td>",l+='<td class="viwebpos-cart-item-action"><div class="viwebpos-cart-item-bt-action-wrap">',l+=`<span class="viwebpos-cart-item-bt-action viwebpos-cart-item-bt-remove" data-position="${a}" data-tooltip="${viwebpos.remove_cart_item}">`,l+='<i class="icon trash alternate outline"></i></span>',l+=`<span class="viwebpos-cart-item-bt-action viwebpos-cart-item-bt-add-note" data-position="${a}" data-tooltip="${viwebpos.add_cart_item_note}">`,l+='<i class="icon exclamation alternate"></i>',l+="</span>",l+="</div></td>",l+="</tr>",l=e(l),l.data({cart_item_key:n}).attr("title",d),l.find(".viwebpos-cart-item-qty").attr({min:0,max:r.max_qty}),l.find(".viwebpos-cart-item-swatches").length&&(l.find('.viwebpos-attribute-options option[value=""]').prop("disabled",!0),e.each(i.variation,(function(e,o){l.find(`select[data-attribute_name="${e}"]`).val(o)}))),s.prepend(e(document).triggerHandler("viwebpos_get_cart_item_html",[l,!1,r,i])||l)})),o||(e(".viwebpos-cart-contents-container").addClass("viwebpos-bill-of-sale-container-empty"),e(".viwebpos-checkout-form-footer-back-to-bill").trigger("click")),e(".viwebpos-cart-contents-order-textarea").val(t.order_note||""),e(".viwebpos-cart-contents-order-note").html(t.order_note||""),s.find(".viwebpos-cart-item-wrap").eq(0).find(".viwebpos-cart-item-bt-action").attr("data-position",a),e(".viwebpos-cart-items-wrap").replaceWith(s)}let i=e(".viwebpos-checkout-form-container");t.customer?i.find(".viwebpos-checkout-search-customer").addClass("viwebpos-checkout-search-customer-found").val(t.customer.email?t.customer.email:t.customer.username).prop("readonly",!0):i.find(".viwebpos-checkout-search-customer").removeClass("viwebpos-checkout-search-customer-found").val("").prop("readonly",!1),i.find(".viwebpos-checkout-form-content-subtotal .viwebpos-checkout-form-content-value").html(viwebpos_get_price_html(t.totals.subtotal)),i.find(".viwebpos-checkout-form-content-tax .viwebpos-checkout-form-content-value").html(viwebpos_get_price_html(t.totals.total_tax)),i.find(".viwebpos-checkout-form-content-need_to_pay .viwebpos-checkout-form-content-value").html(viwebpos_get_price_html(t.totals.total)),viwebpos_get_discounts_html(t.applied_coupons&&t.coupon_discount_totals?t.coupon_discount_totals:{},t.fees?t.fees:{},i.find(".viwebpos-checkout-form-content-coupon"));let c=t.payments.is_paid,a=parseFloat(t.totals.total),r=parseFloat(t.payments.total_paid);c||(c="cash",i.find("#viwebpos-checkout-form-content-value-payment-cash").prop("checked",!0));let p=viwebpos_get_price_html(r,null,null,null,"%2$s"),n=viwebpos_get_price_html(a);if(viwebpos.viwebpos_payments&&i.find(".viwebpos-checkout-form-footer-payment-value").html(viwebpos.viwebpos_payments[c].title),i.find(".viwebpos-checkout-form-content-paid-input:not(.viwebpos-checkout-form-content-paid-input1)").data({val:p}).val(p),i.find(".viwebpos-checkout-form-content-paid-input").data({method:c}),i.find(".viwebpos-checkout-form-content-wrap-payment .viwebpos-checkout-form-content-paid .viwebpos-checkout-form-content-value").html(viwebpos_get_price_html(r)),e(".viwebpos-checkout-form-content-paid-input1").removeClass("viwebpos-checkout-form-content-paid-input1"),i.find(".viwebpos-checkout-form-content-change .viwebpos-checkout-form-content-value").html(viwebpos_get_price_html(t.payments.change)),parseFloat(t.payments.change)<0&&i.find(".viwebpos-checkout-form-content-change .viwebpos-checkout-form-content-value").addClass("viwebpos-checkout-form-content-error"),i.find("#viwebpos-checkout-form-content-value-payment-"+c).prop("checked",!0),a){let o=parseFloat(a.toFixed(0)),t=10;parseInt(viwebpos_price.wc_get_price_decimals)?o%10>0&&(o+=10-o%10):o.toString().length%3?(t=Math.pow(10,3*(Math.ceil(o.toString().length/3)-1)),o%t>0&&(o+=t-o%t)):o%10>0&&(o+=10-o%10);let s="",c=o.toString().length>5?[1,2,5]:[1,2,5,10,20];r>0&&(s+='<div class="viwebpos-checkout-form-content-value-amount" data-val="'+a+'">'+n+"</div>",c.pop()),o>a&&(s+='<div class="viwebpos-checkout-form-content-value-amount" data-val="'+o+'">'+viwebpos_get_price_html(o)+"</div>",c.pop()),e.each(c,(function(e,i){let c=o+i*t;s+='<div class="viwebpos-checkout-form-content-value-amount" data-val="'+c+'">'+viwebpos_get_price_html(c)+"</div>"})),i.find(".viwebpos-checkout-form-content-amount-choose").removeClass("viwebpos-hidden"),i.find(".viwebpos-checkout-form-content-amount-choose .viwebpos-checkout-form-content-value").html(s)}else i.find(".viwebpos-checkout-form-content-amount-choose").addClass("viwebpos-hidden");i.find(".viwebpos-checkout-form-footer-total, .viwebpos-checkout-form-content-total .viwebpos-checkout-form-content-value").html(n),e(document.body).trigger("viwebpos_checkout_search_customers_close"),e(".viwebpos-checkout-form-content-paid-input-checkout_after_change").length&&e(".viwebpos-checkout-form-footer-checkout-wrap").trigger("click"),e(document.body).trigger("viwebpos_settings_pos"),e(".viwebpos-search-product").val()?(e(".viwebpos-search-product").hasClass("viwebpos-search-product-scanned")&&e(document.body).trigger("viwebpos_search_products_close"),e(".viwebpos-search-product").removeClass("viwebpos-search-product-scanned").trigger("focus")):e(".viwebpos-search-product").trigger("focus"),e(document).trigger("viwebpos-bill-of-sale-after-get-html")}))})),window.viwebpos_get_discounts_html=function(o,t,s){if(!(s=e(s)).length)return!1;if(s.data("coupons",o).data("fees",t).addClass("viwebpos-hidden").html(null),!(o&&Object.keys(o).length||t&&Object.keys(t).length))return!1;let i;e.each(o,(function(o,t){i='<div class="viwebpos-checkout-form-content-full-info viwebpos-checkout-form-content-coupon-info viwebpos-checkout-form-content-coupon-info-'+o+'"><div class="viwebpos-checkout-form-content-full-left">',i+='<i class="icon trash alternate outline"></i>'+viwebpos.coupon_title+": "+o+"</div>",i+='<div class="viwebpos-checkout-form-content-full-right">-'+viwebpos_get_price_html(t)+"</div></div>",i=e(i),i.data({coupon:o,discount:t}),s.append(i)})),e.each(t,(function(o,t){i='<div class="viwebpos-checkout-form-content-full-info viwebpos-checkout-form-content-fee viwebpos-checkout-form-content-fee-info-'+o+'"><div class="viwebpos-checkout-form-content-full-left">',i+='<i class="icon trash alternate outline"></i>'+(t.name||t.id)+"</div>",i+='<div class="viwebpos-checkout-form-content-full-right">'+viwebpos_get_price_html(t.total)+"</div></div>",i=e(i),t.redis_cart_discount&&i.addClass("viwebpos-checkout-form-content-fee-redis"),i.data({discount:t,fee_id:o}),s.append(i)})),e(".viwebpos-checkout-add-discount-input").val(""),i&&s.removeClass("viwebpos-hidden")}}(jQuery);